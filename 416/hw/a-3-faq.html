<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title> Assignment 3 FAQ </title>
<link href="../../css/layout.css" rel="stylesheet" type="text/css" />
<link href="../../css/main.css" rel="stylesheet" type="text/css" />
<link href="../../css/print.css" rel="stylesheet" type="text/css" media="print" />
<link href="../../css/main-print.css" rel="stylesheet" type="text/css" media="print" />
<style type="text/css">
/* colors */







 





/* nav bar: not-selected */






/* body colors - greenish */
 /* banner color: red */
 /* title color: red */
 /* heading color: dark/pale green */
 /* darker reddish */

  /* dark red */
 





.subhead {
	background-color: #ddd;
	text-align: center;
	margin-left: 5em;
	margin-right: 5em;
	border: 1px solid #555;
	border-radius: 5px;
}
.note {
	font-style: italic;
	color: #444;
}
#main .faqlist dd {
        margin-left: 2em;
        margin-bottom: 2em;
}
#main .faqlist dt {
        background-color: #D1DBDB;
        border-top: 1px solid black;
        border-bottom: 1px solid black;
        padding-top: 0.25em;
        padding-left: 0.5em;
        color: black;
	font-weight: normal;
}
#main .faqlist dt strong, #main .faqlist dt b {
	color: red;
}
#main .faqlist dt {
	margin-bottom: 1em;
}
#main .faqlist dt p + p {
	padding-top: 1em;
}
#main .faqlist p + pre {
	margin-top: -1em;
}
#main .faqlist dt ul {
	margin-top: 1em;
}
#main .faqlist dt p {
	margin-bottom: 0;
}
#main .newslist dt {
        background-color: white;
        color: #555;
}
#main .answer {
	color: #a00000;
}

</style>
</head>

<body id="s_ru416">
<div id="wrapper">
<!-- _______________________________________ BANNER _______________________________________ -->
<div id="banner">
  <div id="logo">
  <img src="../../css/images/pk-org-pencil.png" alt="pk.org" name="logo" width="122" height="45"/>
  </div>
  <div id="title"> Operating Systems </div>
  <div id="search">
  <form method="get" action="http://www.google.com/search">
	<div style="border:none ;padding:2px;width:25em;">
	<input type="text" name="q" size="25" maxlength="255" value="" />
	<input type="submit" value="Search" />
	<input type="hidden"  name="sitesearch" value="www.pk.org" checked />
	</div>
  </form>
  </div>
  <ul>
    <li class="separator"><a href="../../about/index.html">About</a></li>
    <li class="separator"><a href="../../about/contact.html">Contact</a></li>
    <li><a href="../../sitemap.html">Site map</a></li>
  </ul>
</div>

<!-- _______________________________________ MAIN NAV _______________________________________ -->
<div id="navbar">
	<ul>
	<li class="homelink"><a href="../../index.html">Home</a></li>
<!--
	<li class="aboutlink"><a href="../../about/index.html">About</a></li>
-->
	<li class="ru"><a href="../../rutgers/index.html">Rutgers</a></li>
	<li class="ru352"><a href="../../352/index.html">Internet Technology [352]</a></li>
	<li class="ru416"><a href="../../416/index.html">Operating Systems [416]</a></li>
	<li class="ru417"><a href="../../417/index.html">Distributed Systems [417]</a></li>
	<li class="ru419"><a href="../../419/index.html">Computer Security [419]</a></li>
	<li class="cslink"><a href="../../cs/index.html">Computing</a></li>
	<li class="photolink"><a href="../../photo/index.html">Photography</a></li>
<!--
	<li class="funlink"><a href="#">Coming</a></li>
	<li class="funlink"><a href="#">Soon</a></li>
-->
	</ul>
</div>

<div id="subnav">
<p>
You are in: 
</p>
<ul>
	<li class="first"> <a href="index.html"> Home </a> 
 	<li> <a href="../../rutgers/index.html"> Rutgers </a> 
 	<li> <a href="../index.html"> CS 416 </a> 
 	<li> <a href="../hw/index.html"> Homework </a> 
 	<li> <a href="../hw/a-3-faq.html"> Assignment 3 FAQ </a> 
</ul>
</div>
  
<div id="content-wrapper">
<div id="main">
<div id="headline">
<h1> Assignment 3 FAQ, Errata, and Addenda</h1>
</div>

<div class="subhead">
<span class="strike">Due Friday, February 27, 2015 6:00 pm via sakai</span>><br/>
Due Friday, February 28, 2015 11:59 pm via sakai
</div>

<p>
<em>
Last update:
Saturday, February 28, 2015 08:03 EST

</em>
</p>

<h1> FAQ </h1>
<dl class="faqlist">
<dt>
Should the system be logging the number of system calls made only while tracing is on?
</dt>
<dd>
The process should be counting system calls all the time but printing them only after a call to trace(1) and not printing them initially or after a call to trace(0).
</dd>

<dt>
Should turning tracing off (using trace(0)) should be counted as a system call and added to the total count returned by trace(0)?
</dt>
<dd>
Yes, trace() is a system call so any call to trace will increment the process’ system call counter.
Try adding some system calls between your traces and look at the difference between the trace() counts. For example:
<pre>
	int a, b;
	char *hello = "hello, world\n";

	a = trace(0);
	b = trace(0);
	printf(1, "trace-trace: system calls executed = %d\n", b-a+1);
	a = trace(1);
	write(1, hello, strlen(hello));
	b = trace(0);
	printf(1, "trace-write-trace: system calls executed = %d\n", b-a+1);
	exit();
</pre>
Should produce:
<pre>
trace-trace: system calls executed = 2
pid: 4 [try] syscall(16=write)
hello, world
pid: 4 [try] syscall(22=trace)
trace-write-trace: system calls executed = 3
</pre>
</dd>

<dt>
When and what are we printing in the below example:
<pre>
1.fork()
2.trace (1); //prints fork info from line 1 
3.fork();     // would this print fork information as a system call from trace?
4.trace(0);   //turn off trace
5.trace(1);    //would it print the fork info from the fork at line 3?
</pre>

Please tell me what would print in the console for the above example. 

</dt>
<dd>
When you call trace(1), you are simply trying on system call tracing
from the current point. The is will print the lid, process name,
system call name, and system call number for every system call after
that (from that process). Trace will never print info about previous
calls.
And, yes, trace() counts as a system call just like any other one does. 
</dd>

<dt>
If trace(0) is called in our try.c then we return the number of system calls made so far.
if trace (1) do we also return the system calls made so far?
</dt>
<dd>
Yes. Trace return the same information (total # of system calls so far) no matter what the parameter is. 
</dd>

<dt>
I get high system call counts when I do a printf.
</dt>
<dd>
<p>
<em>printf</em> is not a system call. It's a library function (you can look at the source) that parses the formatting string
and calls the <em>write</em> system call. In many cases, <em>printf</em> will make many calls to <em>write</em>.
Turn on system call tracing and you'll see a stream of writes (which will interfere with the ouput of <em>printf</em>.
</p>
<p>
For example, if you have code such as:
</p>
<pre>
#include "types.h"
#include "user.h"
#include "fcntl.h"

int
main(int argc, char **argv)
{
	int a, b;
	char *hello = "hello, world\n";

	a = trace(0);
	write(1, hello, strlen(hello));
	b = trace(0);
	printf(1, "system calls executed = %d\n", b-a+1);
	exit();
}
</pre>

You’ll get output that looks like:

hello, world
system calls executed = 3

<pre>
If you replace the write() call with
	printf(1, hello);
</pre>

<p>
then you’ll get:
</p>
<pre>
hello, world
system calls executed = 15
</pre>
</dd>

<dt>
I am in a group of three, and our group was wondering if we could get extra credit for doing the optional part of the assignment. 
</dt>
<dd>
Yes, you can get extra credit for the optional part.
</dd>

<dt>
Clarification question: we should add a system call trace, which would accept a 0 or 1 as an int argument
</dt>
<dd>
Correct. Trace will accept 0 or 1 as an argument.
You don't need to check the value;
you can use the C convention of 0 = "trace off" and non-0 = "trace on".
</dd>

<dt>
Clarification question: when we call trace(0) it simply returns number
of system calls made so far and zeros-out
our system call counter for a process
</dt>
<dd>
Not quite. You never reset the system call counter. trace(0) or
trace(1) will always return the number of system calls that the
process has made since it started to run.
</dd>

<dt>
Clarification question: when we call trace(1) we start our system
call counter and print information for each system call during the
execution of our test program. Our system call counter is being
incremented until we get trace(0) system call. After we get trace(0)
system call our counter becomes zero.
</dt>
<dd>
trace(1) will cause all subsequent system calls from this process
following  to be printed
to the console. trace(0) turns the printing off. The per-process
system call counter is <em>never</em> reset.
</dd>

<dt>
How do you run the try.c file? 
</dt>
<dd>
try.c is just the C source for a regular program that you can compile and run under xv6. Compiling it should create an executable called try (which you run by typing the command try). You can create as many programs as you want to test various things. For every program (such as try.c), make sure that you create a target in the Makefile so that it gets compiled. Look at the Makefile and see how other user-level programs (e.g., echo, ls, kill, grep, etc.) are built and add a target for try.c (and/or whatever other programs you want to compile). All you’ll need to do is modify two targets: UPROGS and EXTRA.
</dd>

<dt>
How does the system know to associate that trace call with the system call "sys_trace". I can't seem to understand how you establish that link between the user function and the system call. 
</dt>
<dd>
You should be able to figure this out by inspecting how other system calls work. For example, look at the getpid() system call, which returns the current process ID. Search for all occurrences of getpid in *.h *.S and *.c in the source and take a look at where getpid is used. For example, you’ll see syscall.h defines system call numbers. The magic of creating a user function that ends up doing the system call is implemented in usys.S, which defines SYSCALL. SYSCALL is a macro that defines a symbol for each system call name and, for each call, creates code that will move the system call number to the eax register and then execute a software interrupt (int instruction) to create the mode switch to the system call service routine. You’ll see a list of references to this macro in the file and will need to add one for trace().
</dd>

<dt>
Do we have any requirement for our test programs? As I understand we should submit our test programs along with other changes, right? Currently I have two tests in my test program and I am not sure if it will be enough for a good grade.
</dt>
<dd>
<p>
You should submit one or more test programs with your assignment and, in your document, explain what you’re testing.
At a minimum, be sure to test:
</p>
<ul>
<li> trace on
</li><li> trace off
</li><li> total system call count returned on trace(0)
</li><li> total system call count returned on trace(1)
</li><li> a few function calls that clearly demonstrate testing works (e.g., write, getpid, etc.)
</li>
</ul>
<p>
The key thing is to document what you’re testing and what output you got. I’ll be able to test your kernel with additional programs.
</p>
</dd>

<dt>
If I have three processes, A, B and C. A is running and B and C are ready. Then B preempts A. Who gets an increase in its context switch count? It should be B?
</dt>
<dd>
<p>
Correct.
</p>
<p>
The xv6 scheduler() function is insanely simple. Processes
are forced to give up the CPU on a clock tick - the kernel calls
<em>yield()</em> on a timer interrupt in trap.c.
<em>yield()</em> calls <em>sched()</em>, which
calls <em>swtch()</em> to perform a context switch.  The way xv6 works is
that the scheduler is treated as a separate context. <em>sched()</em> calls
<em>switch()</em> to save the current context (proc->context) and switch to
the scheduler context (cpu->scheduler). This causes the scheduler
to continue its for loop, where it finds a process to run and
switches to it. The wasteful part is that if there’s only once
process in the RUNNABLE state then the scheduler will switch back
to that. You don’t have to worry about this happening. It’s still
performing a context switch, even if a wasteful one, and you should
count it.
</dd>

</dl>
</div>
<div id="footer">
<hr/>
<style type="text/css">  
span.codedirection { unicode-bidi:bidi-override; direction: rtl; }  
</style>  

<p> &copy; 2003-2019 Paul Krzyzanowski. All rights reserved.</p>
<p>For questions or comments about this site, contact Paul Krzyzanowski, 
<span class="codedirection">gro.kp@ofnibew</span>
</p>
<p>
The entire contents of this site are protected by copyright under national and international law.
No part of this site may be copied, reproduced, stored in a retrieval system, or transmitted, in any form,
or by any means whether electronic, mechanical or otherwise without the prior written
consent of the copyright holder.
If there is something on this page that you want to use, please let me know.
</p>
<p>
Any opinions expressed on this page do not necessarily reflect the opinions of my employers and may not
even reflect my own.
</p>
<p> Last updated: February 14, 2019
</p>
<img class="stamp" src="../..//css/images/recycled_pixels_logo.png" alt="recycled pixels" height="80" width="80" />
</div> <!-- footer -->
<div id="tear">
</div>


<div id="sidebar1">
<h1 class="first">Contents </h1>
	<h2> CS 416 </h2>
	<ul>
	<li> <a href="../index.html"> Main course page </a> </li>
	<li> <a href="../news.html"> News </a> </li>
	<li> <a href="../syllabus.html"> Syllabus </a> </li>
	<li> <a href="../hw/index.html"> Homework </a> </li>
	<li> <a href="../notes/index.html"> Documents </a> </li>
	<li> <a href="../exam/index.html"> Exam info </a> </li>
	<li> <a href="../grades/index.html"> Check your grades </a> </li>
	<li> <a href="https://sakai.rutgers.edu/portal"> Sakai </a> </li>
	</ul>

	<h2> CS 417 background </h2>
	<ul>
	<li> <a href="../about.html"> About the course </a> </li>
	<li> <a href="../prereq.html"> Prerequisites </a> </li>
	<li> <a href="../things.html"> Things you need </a> </li>
	<li> <a href="../policy.html"> Policy  </a> </li>
	</ul>

	<h2> CS 417 Assignments </h2>
	<ul>
	<li> <a href="a-1.html"> Assignment 1 </a>
	<li> <a href="a-2.html"> Assignment 2 </a>
	<li> <a href="a-3.html"> Assignment 3 </a>
	<li> <a href="a-4.html"> Assignment 4 </a>
	<li> <a href="a-5.html"> Assignment 5 </a>
	<li> <a href="a-6.html"> Assignment 6 </a>
	<li> <a href="a-7.html"> Assignment 7 </a>
	<li> <a href="a-8.html"> Assignment 8 </a>
	</ul>
	<h2> Tutorials </h2>
	<ul>
<!--
	<li> <a href="../notes/sockets/index.html"> TCP Sockets tutorial </a> </li>
	<li> <a href="../notes/rpc/index.html"> ONC RPC tutorial </a> </li>
-->
	<li> <a href="../notes/c-tutorials/index.html"> C/Unix tutorials </a> </li>
	<li> <a href="../notes/make/index.html"> Makefile tutorial </a> </li>
	</ul>

</div>

<div id="sidebar2">
<!--
<h1 class="first"> Free junk </h1>
<p>
Tedst
</p>
<hr/>
<ul>
<li> List item
</ul>
-->
</div>

</div>
</div>
</body>
</html>
